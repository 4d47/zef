#! perl6
use v6;

use Zef::App;
use Zef::Utils::SystemInfo;

my $app = Zef::App.new;

#| Download a specific distribution
multi MAIN('get', Bool :$depends, Bool :$test-depends, Bool :$build-depends, *@identities) {
    $app.get(|@identities, :$depends, :$test-depends, :$build-depends);
}

#| Download a specific distribution
multi MAIN('test', *@paths) {
    my %results = $app.test(|@paths);
    %results<fail>.elems ?? exit(1) !! exit(0);
}

#| Install
multi MAIN('install', Bool :$depends = True, Bool :$test-depends = True, Bool :$build-depends = True,
                      Bool :v($verbose), Bool :$force, Bool :$skip-tests, :@install-to = ['site'], *@identities) {
    $app.install(|@identities, :$depends, :$test-depends, :$build-depends, :$force, :@install-to, :fetch, :test(?$skip-tests));
}

#| Find that shit
multi MAIN('search', *@identities, *%fields) {
    say $app.search(|@identities, |%fields);
}

